<vex-page-layout mode="card">
  <vex-page-layout-header class="h-6" [class.px-gutter]="true"></vex-page-layout-header>
  <vex-page-layout-content class="-mt-6" [class.px-gutter]="true">
    <div class="card px-8 py-6">
      <mat-tab-group>
        <mat-tab label="Bandeja de Contratos">
          <div class="flex flex-col sm:flex-row gap-x8">
            <div @fadeInUp class="flex-auto">
              <!--<h2 class="text-lg font-bold">Bandeja de Contratos</h2>-->
              <mat-divider></mat-divider>

              <div class="py-4 grid sm:grid-cols-2 md:grid-cols-3 gap-x-8">
                <div class="flex flex-col">
                  <mat-label class="text-primary text-sm font-medium">N°. de expediente</mat-label>
                  <mat-form-field class="flex-auto">
                    <input matInput [formControl]="formGroup.controls.expediente" maxlength="20" placeholder="N°. de expediente" />
                  </mat-form-field>
                </div>
                <div class="flex flex-col">
                  <mat-label class="text-primary text-sm font-medium">Contratista</mat-label>
                  <mat-form-field class="flex-auto">
                    <input matInput [formControl]="formGroup.controls.contratista" maxlength="50" placeholder="Contratista" />
                  </mat-form-field>
                </div>
                <div class="flex flex-col">
                  <mat-label class="text-primary text-sm font-medium">Tipo contrato</mat-label>
                  <mat-form-field class="flex-auto">
                    <mat-select placeholder="Seleccionar" [formControl]="formGroup.controls.tipoContrato">
                      <mat-option [value]="null">Elija una opcion</mat-option>
                      <mat-option *ngFor="let option of tipoContratoOptions" [value]="option.value">
                        {{ option.viewValue }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="flex flex-col">
                  <mat-label class="text-primary text-sm font-medium">Area solicitante</mat-label>
                  <mat-form-field class="flex-auto">
                    <input matInput [formControl]="formGroup.controls.areaSolicitante" maxlength="50" placeholder="Area solicitante" />
                  </mat-form-field>
                </div>

                <div class="flex flex-col">
                </div>

                <div class="flex flex-col sm:flex-row sm:gap-2 items-center justify-end">
                  <button color="primary" mat-stroked-button type="button" (click)="limpiar()">
                    Limpiar
                  </button>
                  <button color="primary" mat-raised-button type="button" (click)="buscar()">
                    Buscar
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="overflow-auto shadow-2xl rounded">
            <table @stagger [dataSource]="dataSource" class="w-full rounded" mat-table matSort matSortActive="expediente" matSortDirection="asc">
              <ng-container matColumnDef="expediente">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>N° de Expediente</th>
                <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.solicitudPerfCont.propuesta.procesoItem.proceso.numeroExpediente }}</td>
              </ng-container>

              <ng-container matColumnDef="contrato">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Contrato</th>
                <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.solicitudPerfCont.tipoContratacion.nombre }}</td>
              </ng-container>

              <ng-container matColumnDef="contratista">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Contratista</th>
                <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.solicitudPerfCont.propuesta.supervisora.nombreRazonSocial }}</td>
              </ng-container>

              <ng-container matColumnDef="tipoContrato">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Tipo de Contrato</th>
                <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ obtenerTipoContrato(element?.estadoContrato) }}</td>
              </ng-container>

              <ng-container matColumnDef="areaSolicitante">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Área Solicitante</th>
                <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.solicitudPerfCont.propuesta.procesoItem.proceso.nombreArea }}</td>
              </ng-container>

              <ng-container matColumnDef="estado">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Estado</th>
                <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.estado.nombre }}</td>
              </ng-container>

              <ng-container matColumnDef="actions">
                <th *matHeaderCellDef mat-header-cell mat-sort-header>Acciones</th>
                <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
                  <button (click)="$event.stopPropagation()" [matMenuTriggerData]="{ customer: row }" [matMenuTriggerFor]="actionsMenu" mat-icon-button type="button">
                    <mat-icon svgIcon="mat:more_horiz"></mat-icon>
                  </button>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
            <mat-paginator class="sticky left-0" [pageSizeOptions]="[10, 20, 30]" (page)="pageChange($event)" showFirstLastButtons></mat-paginator>
          </div>
          <div class="py-4 border-t flex flex-row justify-end">
            <button color="primary" mat-raised-button type="button" (click)="goToBandejaSolicitudes()">
              Regresar
            </button>
          </div>
        </mat-tab>
        <mat-tab label="Supervisor Persona Natural">
          <div class="py-4">
            <h3>Contenido de la Nueva Pestaña</h3>
            <p>Aquí puedes añadir cualquier componente, formulario, tabla o información que desees para esta nueva pestaña.</p>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
  </vex-page-layout-content>
</vex-page-layout>

<mat-menu #actionsMenu="matMenu" xPosition="before" yPosition="below">
  <ng-template let-row="customer" matMenuContent>
    <button mat-menu-item (click)="verDetalle(row)">
      <mat-icon svgIcon="mat:preview"></mat-icon>
      <span>Ver</span>
    </button>
    <button mat-menu-item (click)="procesarContrato(row)">
      <mat-icon svgIcon="mat:update"></mat-icon>
      <span>Editar</span>
    </button>
  </ng-template>
</mat-menu>
