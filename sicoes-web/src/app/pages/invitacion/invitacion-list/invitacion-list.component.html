<vex-page-layout mode="card">
    <vex-page-layout-header
      class="h-6"
      [class.px-gutter]="true"
    ></vex-page-layout-header>
    <vex-page-layout-content class="-mt-6" [class.px-gutter]="true">
      <mat-tab-group selectedIndex="0" #tabgroup class="estilos-tab-invitacion">
        <mat-tab label="Procesos de selección">
          <div class="card px-6 py-4">
            <div class="flex flex-col sm:flex-row gap-4">
              <div @fadeInUp class="flex-auto">
                <!-- TITULO -->
                <h2 class="title m-0 text-primary font-bold">
                  Bandeja de Invitaciones:
                </h2>
                <h3 class="text-primary font-medium">
                  Puedes buscar por 1 o varios filtros
                </h3>
                <hr class="bg-primary" />
                <!-- FILTRO -->
                <div class="py-4 grid sm:grid-cols-2 md:grid-cols-3 gap-x-6">
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Nro del Proceso</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <input
                        [formControl]="formGroup.controls.nroProceso"
                        matInput
                        maxlength="30"
                        placeholder="Ingrese número del proceso"
                      />
                    </mat-form-field>
                  </div>
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Nombre del Proceso</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <input
                        [formControl]="formGroup.controls.nombreProceso"
                        matInput
                        maxlength="100"
                        placeholder="Ingrese Nombre del proceso"
                      />
                    </mat-form-field>
                  </div>
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Ítem</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <input
                        [formControl]="formGroup.controls.item"
                        matInput
                        maxlength="100"
                        placeholder="Ingrese nombre del ítem"
                      />
                    </mat-form-field>
                  </div>
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Sector</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <mat-select
                        [formControl]="formGroup.controls.sector"
                        [compareWith]="compareSelecIdListadoDetalle"
                        placeholder="Seleccionar sector"
                      >
                        <mat-option *ngFor="let obj of listSector" [value]="obj">
                          {{ obj.nombre }}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Sub sector</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <mat-select
                        [formControl]="formGroup.controls.subsector"
                        [compareWith]="compareSelecIdListadoDetalle"
                        placeholder="Seleccionar sub sector"
                      >
                        <mat-option
                          *ngFor="let obj of listSubSector"
                          [value]="obj"
                        >
                          {{ obj.nombre }}
                        </mat-option>
                      </mat-select>
                      <mat-error
                        *ngIf="formGroup.get('sector').hasError('required')"
                        >Ingrese Sector</mat-error
                      >
                    </mat-form-field>
                  </div>
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Estado del ítem</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <mat-select
                        [formControl]="formGroup.controls.estadoItem"
                        [compareWith]="compareSelecIdListadoDetalle"
                        placeholder="Seleccione estado del ítem"
                      >
                        <mat-option
                          *ngFor="let obj of listEstadoItem"
                          [value]="obj"
                        >
                          {{ obj.nombre }}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <!--div class="flex flex-col">
                              <mat-label class="text-primary text-sm font-medium">Estado del proceso</mat-label>
                              <mat-form-field  class="flex-auto">
                                  <mat-select [formControl]="formGroup.controls.estadoProceso" placeholder="Seleccione estado del proceso"
                                      [compareWith]="compareSelecIdListadoDetalle">
                                      <mat-option *ngFor="let obj of listEstado" [value]="obj">
                                          {{ obj.nombre }}
                                      </mat-option>
                                  </mat-select>
                              </mat-form-field>
                          </div-->
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Empresa</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <input
                        [formControl]="formGroup.controls.empresa"
                        matInput
                        maxlength="100"
                        placeholder="Ingresar nombre de la empresa"
                      />
                    </mat-form-field>
                  </div>
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Fecha de Inicio</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <input
                        [formControl]="formGroup.controls.fechaDesde"
                        type="date"
                        min="1900-01-01"
                        max="{{ dateHoy | date : 'yyyy-MM-dd' }}"
                        matInput
                      />
                    </mat-form-field>
                  </div>
                  <div class="flex flex-col">
                    <mat-label class="text-primary text-sm font-medium"
                      >Fecha de Fin</mat-label
                    >
                    <mat-form-field class="flex-auto">
                      <input
                        [formControl]="formGroup.controls.fechaHasta"
                        type="date"
                        min="1900-01-01"
                        matInput
                      />
                      <mat-error
                        *ngIf="formGroup.get('fechaHasta').hasError('required')"
                        >Ingrese Fecha Fin</mat-error
                      >
                    </mat-form-field>
                  </div>
                </div>
  
                <div
                  class="flex flex-col sm:flex-row sm:gap-2 items-center justify-end mb-4"
                >
                  <button
                    color="primary"
                    mat-raised-button
                    type="button"
                    (click)="buscar()"
                  >
                    Buscar
                  </button>
                  <button
                    mat-stroked-button
                    type="button"
                    color="primary"
                    (click)="limpiar()"
                  >
                    Limpiar
                  </button>
                </div>
              </div>
            </div>
            <div class="overflow-auto shadow-2xl rounded">
              <table
                @stagger
                [dataSource]="dataSource"
                class="w-full rounded"
                mat-table
                matSort
              >
                <ng-container matColumnDef="fechaRegistro">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Fecha<br />Invitación
                  </th>
                  <td
                    mat-cell
                    class="text-primary font-medium"
                    *matCellDef="let element"
                  >
                    {{ element?.fechaInvitacion }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="empresa">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Empresa
                  </th>
                  <td
                    mat-cell
                    class="text-primary font-medium"
                    *matCellDef="let element"
                  >
                    {{
                      element?.propuesta?.supervisora?.codigoRuc +
                        " - " +
                        element?.propuesta?.supervisora?.nombreRazonSocial
                    }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="subsectorNombre">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Sector<br />Sub sector
                  </th>
                  <td
                    mat-cell
                    class="text-primary font-medium"
                    *matCellDef="let element"
                  >
                    {{
                      element?.sector?.nombre + " / " + element?.subsector?.nombre
                    }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="numeroExpediente">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Nro<br />Expediente
                  </th>
                  <td
                    mat-cell
                    class="text-primary font-medium"
                    *matCellDef="let element"
                  >
                    {{ element.propuesta.procesoItem.proceso.numeroExpediente }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="nombreProceso">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Nombre del<br />Proceso
                  </th>
                  <td
                    mat-cell
                    class="text-primary font-medium"
                    *matCellDef="let element"
                  >
                    {{
                      element.propuesta.procesoItem.proceso?.numeroProceso +
                        " - " +
                        element.propuesta.procesoItem.proceso?.nombreProceso
                    }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="numeroProceso">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Ítem</th>
                  <td
                    mat-cell
                    class="text-primary font-medium"
                    *matCellDef="let element"
                  >
                    {{ element?.propuesta?.procesoItem?.descripcionItem }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="estadoItem">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Estado<br />Item
                  </th>
                  <td
                    mat-cell
                    class="text-primary font-medium"
                    *matCellDef="let element"
                  >
                    {{ element?.propuesta.procesoItem.estado.nombre }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="estadoInvitacion">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    Estado<br />Invitación
                  </th>
                  <td
                    mat-cell
                    class="text-primary font-medium"
                    *matCellDef="let element"
                  >
                    {{ element?.estado?.nombre }}
                  </td>
                </ng-container>
                <!-- Action Column -->
                <ng-container matColumnDef="actions">
                  <th *matHeaderCellDef mat-header-cell mat-sort-header>
                    Acciones
                  </th>
                  <td
                    *matCellDef="let row"
                    class="w-10 text-primary text-center"
                    mat-cell
                  >
                    <button (click)="ver(row)" matTooltip="Ver invitación">
                      <mat-icon svgIcon="mat:visibility"></mat-icon>
                    </button>
                  </td>
                </ng-container>
  
                <ng-container matColumnDef="loading">
                  <td
                    mat-footer-cell
                    *matFooterCellDef
                    colspan="8"
                    class="text-center"
                  >
                    Cargando Datos...
                  </td>
                </ng-container>
  
                <ng-container matColumnDef="vacio">
                  <td
                    mat-footer-cell
                    *matFooterCellDef
                    colspan="8"
                    class="text-center text-primary"
                  >
                    No se encuentran resultados para los filtros seleccionados
                  </td>
                </ng-container>
  
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                <tr
                  mat-footer-row
                  *matFooterRowDef="['loading']"
                  [ngClass]="{ hide: dataSource != null }"
                ></tr>
                <tr
                  mat-footer-row
                  *matFooterRowDef="['vacio']"
                  [ngClass]="{
                    hide: !(dataSource != null && dataSource.data.length == 0)
                  }"
                ></tr>
              </table>
              <mat-paginator
                class="sticky left-0"
                [pageSizeOptions]="[10, 20, 30]"
                (page)="pageChange($event)"
                showFirstLastButtons
              ></mat-paginator>
            </div>
          </div>
        </mat-tab>
        <mat-tab label="Supervisor Persona Natural">
          <vex-invitacion-supervisor-pn [listInvitacion]="listInvitacion"></vex-invitacion-supervisor-pn>
        </mat-tab>
      </mat-tab-group>
    </vex-page-layout-content>
  </vex-page-layout>
  