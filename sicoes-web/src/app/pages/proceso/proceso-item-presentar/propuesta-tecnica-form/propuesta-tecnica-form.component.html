<div class="w-full h-full overflow-hidden flex flex-col">
        <div class="py-4 px-6 bg-white">
            <div class="flex flex-row mb-4 items-center">
                <button (click)="openDrawer()" class="block" *ngIf="!(isDesktop$ | async)" color="primary" mat-icon-button type="button">
                    <mat-icon svgIcon="mat:menu"></mat-icon>
                </button>  
                <div class="">
                    <div class="text-primary text-xl font-bold">2. Propuesta técnica</div>
                </div>
            </div>
            <div class="">
                <mat-divider></mat-divider>
            </div>
        </div>
        <vex-scrollbar class="px-6 flex-auto bg-white">
            <div class="py-4">
                <div class="flex flex-col sm:flex-row gap-2 sm:gap-4 items-center text-primary pb-4">
                    <mat-label >¿Eres integrante de <strong>consorcio</strong>?</mat-label>
                    <mat-radio-group aria-label="Select an option" class="flex gap-2 items-center" [formControl]="formGroup.controls.consorcio" [(ngModel)]="isEmpresaConsorcio" (change)="agregarEmpresaConsorcio()">
                        <mat-radio-button *ngFor="let obj of listConsorcio" class="bordecmb p-1" [value]="obj.idListadoDetalle" [disabled]="isDisabledAddCompany">{{ obj.nombre }}</mat-radio-button>
                    </mat-radio-group>
                </div>
                <p class="text-primary pb-4 font-medium">Los integrantes de un consorcio no pueden presentar ofertas individuales ni conformar más de un consorcio en un concurso, o en un determinado ítem cuando se trate de concurso según relación de ítems.</p>
                
                <div class="text-primary">
                    <mat-label class="font-bold">Registre porcentaje de participación</mat-label>
                    <div class="py-4 border-b overflow-auto">
                        <table @stagger mat-table [dataSource]="datosEmpresas" class="w-full" matSort>
                            <ng-container matColumnDef="empresa">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Empresa / Postor</th>
                                <td mat-cell *matCellDef="let element" class="ajustar-texto"> {{element?.supervisora.nombreRazonSocial}} </td>
                            </ng-container>

                            <ng-container matColumnDef="ruc">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>RUC</th>
                                <td mat-cell *matCellDef="let element" class="ajustar-texto"> {{element?.supervisora.codigoRuc}} </td>
                            </ng-container>

                            <ng-container matColumnDef="facturacion">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Facturación</th>
                                <td mat-cell *matCellDef="let element" class="ajustar-texto"> S/ {{element?.facturacion}} </td>
                            </ng-container>

                            <ng-container matColumnDef="participacion">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Participación (%)</th>
                                <td mat-cell *matCellDef="let element" class="ajustar-texto">
                                    <mat-form-field class="flex-auto">
                                        <input matInput [value]="element?.participacion" (change)="verificarParticipacion()" (keypress)="numberOnly($event)" [(ngModel)]="element.participacion" type="number"/>
                                    </mat-form-field>
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="acciones">
                                <th mat-header-cell *matHeaderCellDef>Acciones</th>
                                <td mat-cell *matCellDef="let element">
                                    <button mat-icon-button color="primary" (click)="eliminarMiembroConsorcio(element)">
                                    <mat-icon svgIcon="mat:delete"></mat-icon>
                                    </button>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedColumnsCompany"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumnsCompany;"></tr>
                        </table>
                    </div>

                    <br>
                    <mat-label class="font-medium">Facturación total de consorcio:</mat-label>
                    <mat-label class="font-bold" style="margin-left:40%;">S/ {{facturacionTotal}}</mat-label>
                    <mat-label class="font-bold" style="margin-left:10%;">{{participacionTotal}}</mat-label>

                    <div class="py-4 flex flex-row">
                        <span class="flex-auto"></span>
                        <div class="flex flex-row gap-x-2">
                            <button color="primary" mat-stroked-button type="button" (click)="openModalEmpresaConsorcio()">
                                Agregar miembro
                            </button>
                            <button color="primary" mat-raised-button type="button" (click)="registrarParticipacion()">
                                Registrar
                            </button>
                        </div>
                    </div>
                </div>
               
                <div class="">
                    <mat-divider></mat-divider>
                </div>
                <div class="py-4 grid justify-center gap-2 sm:flex sm:items-center sm:justify-between">
                    <div class="column text-primary">
                        <mat-label class="font-bold">Adjunta tus documentos que forman parte de tu propuesta técnica:</mat-label><br>
                        <mat-label class="font-medium">Consideraciones</mat-label><br>
                        <mat-label class="font-medium">El formato de archivo soportado es PDF.</mat-label><br>
                        <mat-label class="font-medium">Puedes subir hasta 10 archivos, cada uno con un peso máximo de 10 MB</mat-label>
                    </div>
                    <button color="primary" mat-raised-button type="button" (click)="agregarDocumento()">Agregar Documento</button>
                </div>
            </div>
            <div class="py-4 border-b overflow-auto">
                <table @stagger mat-table [dataSource]="dataSource" class="w-full" matSort>
                    <ng-container matColumnDef="descripcion">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Descripción</th>
                        <td mat-cell *matCellDef="let element" class="ajustar-texto"> {{element?.descripcion}} </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="archivo">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Archivos</th>
                        <td *matCellDef="let row" mat-cell>
                            <div class="flex items-center gap-1 cursor-pointer">
                                <div *ngIf="row.tipoArchivo" (click)="descargarArchivo(row)"
                                    [ngClass]="['text-purple', 'bg-purple-light']"
                                    class="rounded px-2 py-1 font-medium text-xs flex-none">
                                    {{ row.tipoArchivo.nombre }}
                                </div>
                            </div>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="acciones">
                        <th *matHeaderCellDef mat-header-cell mat-sort-header>Acciones</th>
                        <td *matCellDef="let row" class="w-10 text-primary" mat-cell>
                            <div class="flex">
                                <button (click)="actualizarVer(row, 'edit')">
                                    <mat-icon svgIcon="mat:edit"></mat-icon>
                                </button>
                                <div class="v-line mx-2"></div>
                                <button (click)="eliminarDocumento(row)">
                                    <mat-icon svgIcon="mat:delete"></mat-icon>
                                </button>
                            </div>
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="loading">
                        <td mat-footer-cell *matFooterCellDef colspan="3" class="text-center">
                            Cargando Datos...
                        </td>
                    </ng-container>
    
                    <ng-container matColumnDef="vacio">
                        <td mat-footer-cell *matFooterCellDef colspan="3" class="text-center text-primary">
                            No se encuentran resultados para los filtros seleccionados
                        </td>
                    </ng-container>
    
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    <tr mat-footer-row *matFooterRowDef="['loading']" [ngClass]="{'hide': dataSource != null}"></tr>
                </table>
    
                <mat-paginator class="sticky left-0" [pageSizeOptions]="[10, 20, 30]" showFirstLastButtons></mat-paginator>
            </div>
        </vex-scrollbar>

    <div class="bg-white grid justify-center sm:flex gap-4 py-4">
        <button color="primary" class="py-2" mat-stroked-button type="button" (click)="verModalDocumentosInformativos()">
            <mat-icon svgIcon="mat:remove_red_eye"></mat-icon>
            <div class="text-left ml-2">
                <p class="font-bold">Ver documentos administrativos:</p>
                <p>Ir a lista de requisitos para presentar.</p>
            </div>
        </button>
        <a color="primary" href="https://www.osinergmin.gob.pe/seccion/institucional/institucional/procesos-seleccion/" class="py-2" mat-button mat-stroked-button target="_blank">
            <mat-icon class="mat-icon-button" svgIcon="mat:insert_link"></mat-icon>
            <div class="text-left ml-2">
                <p class="font-bold border-b border-primary">Ver listados de proceso de selección:</p>
                <p>Irás a la página de Osinergmin.</p>
            </div>
          </a>
    </div>
    <div class="py-4 border-t flex flex-row">
        <button color="primary" mat-stroked-button type="button" (click)="cancelar()">
            Cancelar
        </button>
        <span class="flex-auto"></span>
        <div class="flex flex-row gap-x-2">
            <button color="primary" mat-stroked-button type="button" (click)="guardarPropuestaTecnica(false)">
                Guardar y Salir
            </button>
            <button color="primary" mat-raised-button type="button" (click)="guardarPropuestaTecnica(true)">
                Guardar y Continuar
            </button>
        </div>
    </div>
</div>
<mat-menu #actionsMenu="matMenu" xPosition="before" yPosition="below">
    <ng-template let-obj="obj" matMenuContent>
        <button (click)="actualizarVer(obj, 'edit')" mat-menu-item>
            <mat-icon svgIcon="mat:edit"></mat-icon>
            <span>Modificar</span>
        </button>
        <button (click)="eliminarDocumento(obj)" mat-menu-item>
            <mat-icon svgIcon="mat:delete"></mat-icon>
            <span>Eliminar</span>
        </button>
    </ng-template>
</mat-menu>
