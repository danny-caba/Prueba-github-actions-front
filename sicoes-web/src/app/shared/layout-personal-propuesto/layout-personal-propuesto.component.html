<div class="flex flex-col sm:flex-row sm:gap-4 mt-4">
  <mat-form-field class="flex-auto">
    <mat-label>Nombres y Apellidos</mat-label>
    <mat-select [formControl]="formGroup.controls.nombreCompleto">
      <mat-option [value]="null" disabled>Seleccione personal</mat-option>
      <mat-option *ngFor="let obj of listPersonalPropuesto" [value]="obj">
        {{ obj.nombreCompleto }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="formGroup.get('nombreCompleto')?.hasError('required')">
      Seleccione personal
    </mat-error>
  </mat-form-field>
  <button color="primary" mat-raised-button type="button" (click)="doNothing()">Agregar</button>
</div>
<div *ngFor="let personal of listPersonalPropuesto">
    <ng-container [ngTemplateOutletContext]="{ otro: personal }" [ngTemplateOutlet]="templateNepotismo"></ng-container>
    <ng-container [ngTemplateOutletContext]="{ otro: personal }" [ngTemplateOutlet]="templateImpedimento"></ng-container>
    <ng-container [ngTemplateOutletContext]="{ otro: personal }" [ngTemplateOutlet]="templateNoVinculo"></ng-container>
    <ng-container [ngTemplateOutletContext]="{ otro: personal }" [ngTemplateOutlet]="templateOtros"></ng-container>
</div>

<div class="w-full overflow-x-auto shadow-2xl rounded">
    <table @stagger [dataSource]="listPersonalAgregado" class="w-full table-auto" mat-table matSort>
      <ng-container matColumnDef="tipoDocumento">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Tipo de<br>Documento</th>
        <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.tipoDocumento }}</td>
      </ng-container>

      <ng-container matColumnDef="numeroDocumento">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Número de<br>Documento</th>
        <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.numeroDocumento }}</td>
      </ng-container>

      <ng-container matColumnDef="nombreCompleto">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombres y apellidos</th>
        <td class="text-primary font-medium break-words whitespace-normal min-w-[100px] py-2" mat-cell *matCellDef="let element">{{ element?.nombreCompleto }}</td>
      </ng-container>

      <ng-container matColumnDef="djNepotismo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>DJ del personal<br>propuesto por la<br>empresa (Nepotismo)</th>
        <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.perfil }}</td>
      </ng-container>

      <ng-container matColumnDef="djImpedimento">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>DJ impedimentos /<br>incompatibilidad y<br>prohibiciones</th>
        <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.fechaRegistro }}</td>
      </ng-container>

      <ng-container matColumnDef="djNoVinculo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>DJ no vínculo<br>contractual con<br>agente supervisado</th>
        <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.fechaInicioContractual }}</td>
      </ng-container>

      <ng-container matColumnDef="otrosDocumentos">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha<br>Otros<br>documentos</th>
        <td class="text-primary font-medium" mat-cell *matCellDef="let element">{{ element?.estadoReemplazo }}</td>
      </ng-container>

      <!-- Action Column -->

      <ng-container matColumnDef="actions">
        <th *matHeaderCellDef mat-header-cell mat-sort-header>Acciones</th>
        <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
          <button (click)="doNothing()"
            mat-icon-button
            type="button">
            <mat-icon svgIcon="mat:delete"></mat-icon>
          </button>
        </td>
      </ng-container>

      <ng-container matColumnDef="vacio">
        <td mat-footer-cell *matFooterCellDef colspan="9"
        class="text-center text-primary">
        No se encuentran datos para mostrar
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

      <tr mat-footer-row *matFooterRowDef="['vacio']"
        [class.hidden]="listPersonalAgregado?.length > 0">
      </tr>
    </table>
</div>

<ng-template #templateNepotismo let-otro="otro">
    <div class="flex">
        <div class="flex flex-col">
            <mat-checkbox color="primary" (change)="setValueCheckedDjNepotismo(formGroup, $event)">
                <span>DJ del personal propuesto por la empresa (Nepotismo)</span>
            </mat-checkbox>
        </div>
        <span class="flex-1"></span>
        <vex-form-adjuntos-btn class="ml-6" [editable]="editable"></vex-form-adjuntos-btn>
    </div>
</ng-template>

<ng-template #templateImpedimento let-otro="otro">
    <div class="flex">
        <div class="flex flex-col">
            <mat-checkbox color="primary" (change)="setValueCheckedDjImpedimento(formGroup, $event)">
                <span>DJ impedimentos / incompatibilidad y prohibiciones</span>
            </mat-checkbox>
        </div>
        <span class="flex-1"></span>
        <vex-form-adjuntos-btn class="ml-6" [editable]="editable"></vex-form-adjuntos-btn>
    </div>
</ng-template>

<ng-template #templateNoVinculo let-otro="otro">
    <div class="flex">
        <div class="flex flex-col">
            <mat-checkbox color="primary" (change)="setValueCheckedDjNoVinculo(formGroup, $event)">
                <span>DJ no vínculo contractual con agente supervisado</span>
            </mat-checkbox>
        </div>
        <span class="flex-1"></span>
        <vex-form-adjuntos-btn class="ml-6" [editable]="editable"></vex-form-adjuntos-btn>
    </div>
</ng-template>

<ng-template #templateOtros let-otro="otro">
    <div class="flex">
        <div class="flex flex-col">
            <mat-checkbox color="primary" (change)="setValueCheckedOtros(formGroup, $event)">
                <span>Otros documentos</span>
            </mat-checkbox>
        </div>
        <span class="flex-1"></span>
        <vex-form-adjuntos-btn class="ml-6" [editable]="editable"></vex-form-adjuntos-btn>
    </div>
</ng-template>
