<h2 mat-dialog-title>Historial de Aprobación</h2>

<mat-dialog-content>

  <div *ngIf="isLoading" class="text-center my-4">
    <mat-spinner diameter="40"></mat-spinner>
  </div>
  <div *ngIf="error" class="text-error">{{ error }}</div>

  <table mat-table [dataSource]="dataSource" class="w-full" *ngIf="!isLoading && !error">

    <!-- Tipo -->
    <ng-container matColumnDef="tipo">
      <th mat-header-cell *matHeaderCellDef>Tipo</th>
      <td mat-cell *matCellDef="let row">{{ row.tipoLado }}</td>
    </ng-container>

    <!-- Fecha Registro -->
    <ng-container matColumnDef="fechaRegistro">
      <th mat-header-cell *matHeaderCellDef>Fecha Registro</th>
      <td mat-cell *matCellDef="let row">{{ row.fechaCreacion | date:'dd/MM/yyyy HH:mm' }}</td>
    </ng-container>

    <!-- Usuario -->
    <ng-container matColumnDef="usuario">
      <th mat-header-cell *matHeaderCellDef>Usuario</th>
      <td mat-cell *matCellDef="let row">{{ row.usuario }}</td>
    </ng-container>

    <!-- Fecha Aprobación -->
    <ng-container matColumnDef="fechaAprobacion">
      <th mat-header-cell *matHeaderCellDef>Fecha Aprobación</th>
      <td mat-cell *matCellDef="let row">
        {{ row.fechaAprobacion ? (row.fechaAprobacion | date:'dd/MM/yyyy HH:mm') : '—' }}
      </td>
    </ng-container>

    <!-- Resultado -->
    <ng-container matColumnDef="resultado">
      <th mat-header-cell *matHeaderCellDef>Resultado</th>
      <td mat-cell *matCellDef="let row">{{ row.tipoEvaluacion }}</td>
    </ng-container>

    <!-- Observación -->
    <ng-container matColumnDef="observacion">
      <th mat-header-cell *matHeaderCellDef>Observación</th>
      <td mat-cell *matCellDef="let row">{{ row.observacion }}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row        *matRowDef="let row; columns: displayedColumns"></tr>
  </table>

  <p *ngIf="!isLoading && dataSource.data.length === 0" class="text-center my-4">
    No hay entradas en el historial.
  </p>

</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cerrar()">Cerrar</button>
</mat-dialog-actions>
